#!/usr/bin/env ruby

require 'thor'
require_relative '../lib/sfb_scripts/tester'

class CLI < Thor
  class_option :verbose, type: :boolean, desc: "Pipe the log file to stdout."
  class_option :loud, type: :boolean, desc: "Show all shell commands being run.  This *does not* show the output of those commands, only what is being run."
  #
  # run
  #
  desc "status", "Find dirty tests in your git status and run them."
  option :all_engines, :type => :boolean, :desc => 'Run all tests identified, regardless of engine'
  option :no_selenium, :type => :boolean, :desc => 'Ignore selenium'
  def status
    Tester.status(options)
  end

  #
  # run
  #
  desc "find", <<-DESC
    Find tests and run them. By trying to match an individual test or the name of a test file(s).
  DESC
  def find(input)
    if input == '--help'
      puts "use 'test_runner --help find' to see the help"
      exit
    end

    Tester.find(input, options)
  end

  desc "status_check", "Verify that you don't edit a file without editing its corresponding test file."
  option :confirm_exit_status, :type => :boolean, :desc => 'Asks user whether to exit with status 0 or 1.  Used in the pre-commit hook'
  def status_check
    Tester.status_check(options)
  end

  default_task :status_check

end

CLI.start(ARGV)
